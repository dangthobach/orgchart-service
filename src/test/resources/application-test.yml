spring:
  application:
    name: orgchart-service-test

  # Test database configuration (H2 in-memory for performance testing)
  datasource:
    url: jdbc:h2:mem:testdb;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE
    driver-class-name: org.h2.Driver
    username: sa
    password:

  # JPA configuration for test
  jpa:
    hibernate:
      ddl-auto: create-drop
    show-sql: false
    properties:
      hibernate:
        format_sql: false
        dialect: org.hibernate.dialect.H2Dialect
        order_inserts: true
        order_updates: true
        jdbc:
          batch_size: 1000
          batch_versioned_data: true

  # Disable data.sql initialization for tests
  sql:
    init:
      mode: never

# Logging configuration for performance tests  
logging:
  level:
    com.learnmore: INFO
    com.learnmore.application.performance: DEBUG
    com.learnmore.application.utils: DEBUG
    org.springframework: WARN
    org.hibernate: WARN
    org.apache.poi: WARN
    
  pattern:
    console: "%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n"

# Performance test specific configuration
performance:
  excel:
    temp-directory: target/performance-tests
    cleanup-after-test: true
    enable-memory-monitoring: true
    batch-size: 5000
    max-memory-threshold: 2048

# Multi-Sheet Migration Configuration (for tests)
sheets:
  - name: "HSBG_theo_hop_dong"
    enabled: true
    order: 1
    description: "Hồ sơ bàn giao theo hợp đồng"
    dtoClass: "com.learnmore.application.dto.migration.sheet.HopDongDTO"
    stagingRawTable: "staging_raw_hopd"
    stagingValidTable: "staging_valid_hopd"
    stagingErrorTable: "staging_error_multisheet"
    masterTable: "case_detail"
    batchSize: 5000
    parallelProcessing: false
    enableMasking: true
    validationRules: []
  - name: "HSBG_theo_CIF"
    enabled: true
    order: 2
    description: "Hồ sơ bàn giao theo CIF khách hàng"
    dtoClass: "com.learnmore.application.dto.migration.sheet.CifDTO"
    stagingRawTable: "staging_raw_cif"
    stagingValidTable: "staging_valid_cif"
    stagingErrorTable: "staging_error_multisheet"
    masterTable: "case_detail_cif"
    batchSize: 5000
    parallelProcessing: false
    enableMasking: true
    validationRules: []
  - name: "HSBG_theo_tap"
    enabled: true
    order: 3
    description: "Hồ sơ bàn giao theo tập"
    dtoClass: "com.learnmore.application.dto.migration.sheet.TapDTO"
    stagingRawTable: "staging_raw_tap"
    stagingValidTable: "staging_valid_tap"
    stagingErrorTable: "staging_error_multisheet"
    masterTable: "case_detail_tap"
    batchSize: 5000
    parallelProcessing: false
    enableMasking: false
    validationRules: []

global:
  ingestTimeout: 300000
  validationTimeout: 600000
  insertionTimeout: 900000
  enableMonitoring: true
  progressUpdateInterval: 5000
  stopOnFirstError: false
  maxErrorsPerSheet: 10000
  continueOnSheetFailure: true
  useParallelSheetProcessing: true
  maxConcurrentSheets: 3
  autoCleanupOnSuccess: false
  autoCleanupOnFailure: false
  retentionDays: 30